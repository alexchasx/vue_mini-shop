(function(){"use strict";var t={7576:function(t,n,e){var r=e(9242),o=e(3396),c=e(7139);const i={class:"container"},a={class:"row"},s=(0,o._)("div",{class:"col col-sm-9"},[(0,o._)("h1",null,"Site")],-1),l={class:"col col-sm-3"},u={class:"alert alert-default"},d=(0,o._)("hr",null,null,-1),p={class:"container"},m={class:"row"},v={class:"col col-sm-3 menu"},h={class:"list-group"},f={class:"col col-sm-9"};function g(t,n,e,r,g,w){const _=(0,o.up)("router-link"),k=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("header",null,[(0,o._)("div",i,[(0,o._)("div",a,[s,(0,o._)("div",l,[(0,o._)("div",u,[(0,o._)("div",null,"In Cart: "+(0,c.zw)(t.$store.getters["cart/length"]),1),(0,o._)("div",null,"Total: "+(0,c.zw)(t.$store.getters["cart/total"]),1)])])]),d])]),(0,o._)("section",null,[(0,o._)("div",p,[(0,o._)("div",m,[(0,o._)("div",v,[(0,o._)("ul",h,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(g.menu,(t=>((0,o.wg)(),(0,o.iD)("li",{class:"list-group-item",key:t.route},[(0,o.Wm)(_,{href:"#",to:{name:t.route},"exact-active-class":"text-danger"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,c.zw)(t.text),1)])),_:2},1032,["to"])])))),128))])]),(0,o._)("div",f,[(0,o.Wm)(k)])])])])])}var w={data(){return{menu:[{route:"catalog",text:"Products"},{route:"cart",text:"Cart"},{route:"checkout",text:"Order"}]}}},_=e(89);const k=(0,_.Z)(w,[["render",g]]);var b=k,y=e(65),C={namespaced:!0,state:{items:[]},getters:{all:t=>t.items,one:t=>n=>t.items.find((t=>t.id==n))},mutations:{setItems(t,n){t.items=n}},actions:{async load({commit:t}){try{const n=await fetch("http://faceprog.ru/reactcourseapi/products/all.php"),e=await n.json();t("setItems",e)}catch(n){console.log("error",n)}}}};e(7658);const D="http://faceprog.ru/reactcourseapi/cart/";var O={namespaced:!0,state:{items:[],token:null},getters:{inCart:t=>n=>t.items.some((t=>t.id==n)),length:t=>t.items.length,itemsDetailed:(t,n,e,r)=>t.items.map((t=>{const n=r["products/one"](t.id);return{...n,cnt:t.cnt}})),total:(t,n)=>n.itemsDetailed.reduce(((t,n)=>t+n.price*n.cnt),0)},mutations:{load(t,{cart:n,token:e}){t.items=n,t.token=e},add(t,n){t.items.push({id:n,cnt:1})},remove(t,n){t.items=t.items.filter((t=>t.id!=n))},setCnt(t,{id:n,cnt:e}){const r=t.items.find((t=>t.id==n));r.cnt=e}},actions:{async load({commit:t}){try{const n=localStorage.getItem("CART__TOKEN"),e=await fetch(`${D}load.php?token=${n}`),{cart:r,token:o,needUpdate:c}=await e.json();c&&localStorage.setItem("CART__TOKEN",o),t("load",{cart:r,token:o})}catch(n){console.log("error",n)}},async add({commit:t,getters:n,state:e},r){if(!n.inCart(r))try{const n=await fetch(`${D}add.php?token=${e.token}&id=${r}`),o=await n.json();o&&t("add",r)}catch(o){console.log("error",o)}},async remove({commit:t,getters:n,state:e},r){if(n.inCart(r))try{const n=await fetch(`${D}remove.php?token=${e.token}&id=${r}`),o=await n.json();o&&t("remove",r)}catch(o){console.log("error",o)}},setCnt({commit:t,getters:n},{id:e,cnt:r}){if(n.inCart(e)){const o=n.itemsDetailed.find((t=>t.id==e)),c=Math.min(Math.max(r,1),o.rest);t("setCnt",{id:e,cnt:c})}}}};const $={modules:{products:C,cart:O},strict:!1};var x=(0,y.MT)($),j=e(2483);const z=(0,o._)("h1",null,"Products",-1),P={class:"row"},T={class:"card"},I={class:"card-body"},S=(0,o._)("hr",null,null,-1),Z=["onClick"],A=["onClick"];function K(t,n,e,r,i,a){const s=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[z,(0,o._)("div",P,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.productList,(n=>((0,o.wg)(),(0,o.iD)("div",{class:"col col-sm-4 mb-3 mt-3",key:n.id},[(0,o._)("div",T,[(0,o._)("div",I,[(0,o._)("h3",null,(0,c.zw)(n.title),1),(0,o._)("div",null,"Price: "+(0,c.zw)(n.price),1),(0,o.Wm)(s,{to:{name:"product",params:{id:n.id}}},{default:(0,o.w5)((()=>[(0,o.Uk)("Read more")])),_:2},1032,["to"]),S,t.inCart(n.id)?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:e=>t.remove(n.id),type:"button",class:"btn btn-danger"}," Remove ",8,Z)):((0,o.wg)(),(0,o.iD)("button",{key:1,onClick:e=>t.add(n.id),type:"button",class:"btn btn-success"}," Add to cart ",8,A))])])])))),128))])])}var R={computed:{...(0,y.Se)("products",{productList:"all"}),...(0,y.Se)("cart",["inCart"])},methods:{...(0,y.nv)("cart",["add","remove"])}};const E=(0,_.Z)(R,[["render",K]]);var M=E;const U=(0,o._)("h1",null,"Cart",-1),W=(0,o._)("hr",null,null,-1),H=["onClick"],Y=["onClick"],B=(0,o._)("hr",null,null,-1);function L(t,n,e,r,i,a){const s=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[U,W,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.products,(n=>((0,o.wg)(),(0,o.iD)("div",{key:n.id},[(0,o._)("div",null,"Title: "+(0,c.zw)(n.title),1),(0,o._)("div",null,"Price: "+(0,c.zw)(n.price),1),(0,o._)("div",null,"Cnt: "+(0,c.zw)(n.cnt),1),(0,o._)("div",null,"Total: "+(0,c.zw)(n.price*n.cnt),1),(0,o._)("button",{class:"btn btn-warning me-2",onClick:e=>t.setCnt({id:n.id,cnt:n.cnt-1})}," -1 ",8,H),(0,o._)("button",{class:"btn btn-success",onClick:e=>t.setCnt({id:n.id,cnt:n.cnt+1})}," +1 ",8,Y),B])))),128)),(0,o.Wm)(s,{class:"btn btn-success",to:{name:"checkout"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Order now")])),_:1})])}var N={computed:{...(0,y.Se)("cart",{products:"itemsDetailed"})},methods:{...(0,y.nv)("cart",["setCnt"])}};const F=(0,_.Z)(N,[["render",L]]);var q=F;const G=(0,o._)("h1",null,"Order now",-1),J=(0,o._)("hr",null,null,-1),Q=[G,J];function V(t,n,e,r,c,i){return(0,o.wg)(),(0,o.iD)("div",null,Q)}var X={};const tt=(0,_.Z)(X,[["render",V]]);var nt=tt;const et=(0,o._)("h1",null,"Page not found",-1),rt=(0,o._)("hr",null,null,-1),ot=[et,rt];function ct(t,n,e,r,c,i){return(0,o.wg)(),(0,o.iD)("div",null,ot)}var it={};const at=(0,_.Z)(it,[["render",ct]]);var st=at;const lt={key:0},ut=(0,o._)("hr",null,null,-1),dt=(0,o._)("hr",null,null,-1);function pt(t,n,e,r,i,a){const s=(0,o.up)("app-e-404");return a.hasProduct?((0,o.wg)(),(0,o.iD)("div",lt,[(0,o._)("h1",null,(0,c.zw)(a.product.title),1),ut,(0,o._)("div",null,"Price: "+(0,c.zw)(a.product.price),1),dt,t.inCart(t.$route.params.id)?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:n[0]||(n[0]=n=>t.remove(t.$route.params.id)),type:"button",class:"btn btn-danger"}," Remove ")):((0,o.wg)(),(0,o.iD)("button",{key:1,onClick:n[1]||(n[1]=n=>t.add(t.$route.params.id)),type:"button",class:"btn btn-success"}," Add to cart "))])):((0,o.wg)(),(0,o.j4)(s,{key:1}))}var mt={components:{AppE404:st},computed:{...(0,y.Se)("products",{productById:"one"}),...(0,y.Se)("cart",["inCart"]),id(){return parseInt(this.$route.params.id)},validId(){return/^[1-9]+\d*$/.test()},product(){return this.productById(this.id)},hasProduct(){return void 0!==this.product}},methods:{...(0,y.nv)("cart",["add","remove"])}};const vt=(0,_.Z)(mt,[["render",pt]]);var ht=vt;const ft=[{name:"catalog",path:"/",component:M},{name:"cart",path:"/cart",component:q},{name:"checkout",path:"/order",component:nt},{name:"product",path:"/product/:id",component:ht},{path:"/:any(.*)",component:st}];var gt=(0,j.p7)({routes:ft,history:(0,j.PO)()});x.dispatch("products/load").then((()=>{(0,r.ri)(b).use(x).use(gt).mount("#app")})),x.dispatch("cart/load")}},n={};function e(r){var o=n[r];if(void 0!==o)return o.exports;var c=n[r]={exports:{}};return t[r].call(c.exports,c,c.exports,e),c.exports}e.m=t,function(){var t=[];e.O=function(n,r,o,c){if(!r){var i=1/0;for(u=0;u<t.length;u++){r=t[u][0],o=t[u][1],c=t[u][2];for(var a=!0,s=0;s<r.length;s++)(!1&c||i>=c)&&Object.keys(e.O).every((function(t){return e.O[t](r[s])}))?r.splice(s--,1):(a=!1,c<i&&(i=c));if(a){t.splice(u--,1);var l=o();void 0!==l&&(n=l)}}return n}c=c||0;for(var u=t.length;u>0&&t[u-1][2]>c;u--)t[u]=t[u-1];t[u]=[r,o,c]}}(),function(){e.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(n,{a:n}),n}}(),function(){e.d=function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)}}(),function(){var t={143:0};e.O.j=function(n){return 0===t[n]};var n=function(n,r){var o,c,i=r[0],a=r[1],s=r[2],l=0;if(i.some((function(n){return 0!==t[n]}))){for(o in a)e.o(a,o)&&(e.m[o]=a[o]);if(s)var u=s(e)}for(n&&n(r);l<i.length;l++)c=i[l],e.o(t,c)&&t[c]&&t[c][0](),t[c]=0;return e.O(u)},r=self["webpackChunk_09_routing"]=self["webpackChunk_09_routing"]||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))}();var r=e.O(void 0,[998],(function(){return e(7576)}));r=e.O(r)})();
//# sourceMappingURL=app.614e7e96.js.map